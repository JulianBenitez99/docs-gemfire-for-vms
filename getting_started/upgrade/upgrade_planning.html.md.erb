---
title:  Planning an Upgrade
---

Before you upgrade your system, back it up.  Make backup copies of all existing disk-stores,
server-side code, configuration files, and data across the entire cluster.  To get a backup of the
data that includes the most recent changes may require that traffic across the cluster is stopped
before the backup is made.
The discussion at [Creating Backups for System Recovery and Operational Management](/geode/managing/disk_storage/backup_restore_disk_store.html#backup_restore_disk_store)
explains the process, and the
[backup disk-store](/geode/tools_modules/gfsh/command-pages/backup.html) command reference page describes
how to use the `gfsh backup disk-store` command to make a backup.

## <a id="guidelines-upgrading"></a>Guidelines for Upgrading

-   Schedule your upgrade during a period of low user activity for your system and network.
-   **Important:** After all locators have been upgraded, *do not start or restart any processes* that use the older version of the software. The older process will either not be allowed to join the distributed system or, if allowed to join, can potentially cause a deadlock.
-   Verify that all members that you wish to upgrade are members of the same distributed system cluster.
A list of cluster members will be output with the `gfsh` command:

    ``` pre
    gfsh>list members
    ```

-   Locate a copy of your system's startup script, if your site has one (most do). The startup script can be a handy reference for restarting upgraded locators and servers with the same `gfsh` command lines that were used in your current installation.

- Identify how your current cluster configuration was specified. The way in which your cluster
  configuration was created determines which commands you use to save and restore that cluster
  configuration during the upgrade procedure.  There are two possibilites:

  - With `gfsh` commands, relying on the underlying **cluster configuration service** to record the configuration: see [Exporting and Importing Cluster Configurations](/geode/configuring/cluster_config/export-import.html).
  - With **XML properties** specified through the Java API or configuration files: see [Deploying Configuration Files without the Cluster Configuration Service](/geode/configuring/running/deploying_config_files.html).

-   Do not modify region attributes or data, either via `gfsh` or `cache.xml` configuration, during the upgrade process.

## <a id="version_compatibilities"></a>Version Compatibilities

Your choice of upgrade procedure depends, in part, on the versions of <%=vars.product_name_long%> involved.

- **Version Compatibility Between Peers and Cache Servers**

    For best reliability and performance, all server components of a <%=vars.product_name%> system should run the same version of the software.
    For the purposes of a rolling upgrade, you can have peers or cache servers running different minor
    versions of <%=vars.product_name_long%> at the same time, as long as the major version is the same. For example,
    some components can continue to run under version 9.0 while you are in the process of upgrading to
    version 9.1.

- **Version Compatibility Between Clients and Servers**

    <%=vars.product_name%> clients can run version 8.2.3 or a more recent 8.2 version of <%=vars.product_name%> and still connect to
    <%=vars.product_name%> servers running version 9.x.
    Version 9.x clients, however, cannot connect to servers running older versions of <%=vars.product_name%>.

- **Version Compatibility Between Sites in Multi-Site (WAN) Deployments**

    In multi-site (WAN) deployments, one site can be running <%=vars.product_name%> 8.2.3 or a more recent <%=vars.product_name%> 8.2
    version, and another site can be running <%=vars.product_name%> 9.x.  The sites should still be able to communicate
    with one another.

## <a id="upgrade-latest-v9-from-earlier-v9"></a>Upgrade to the Latest Version 9 from an Earlier Version 9

If possible, follow the [Rolling Upgrade](upgrade_rolling.html) procedure.  A multi-site
installation can also do rolling upgrades within each site.  If a rolling upgrade is not possible,
follow the [Off-Line Upgrade](upgrade_offline.html) procedure.
A rolling upgrade is not possible for a cluster that has partitioned regions without redundancy.
Without the redundancy, region entries will be lost when individual servers are taken out of the
cluster during a rolling upgrade.

## <a id="java-notes"></a>Java Notes

- To check your current Java version, type `java -version` at a command-line prompt.

- <%=vars.product_name_long%> 9.x requires Java SE 8, version <%=vars.min_java_update%> or a more recent version.

- The <%=vars.product_name_long%> product download does not include Java.
You must download and install a supported JRE or JDK on each system
running <%=vars.product_name%>. To obtain best performance with commands such as `gfsh status` and `gfsh stop`,
install a full JDK (not just a JRE).
